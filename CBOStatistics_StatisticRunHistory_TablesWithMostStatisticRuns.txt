SELECT NULL OWNER, NULL TABLE_NAME, NULL PARTITION_NAME, 
  NULL STATISTICS_IN_HISTORY FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL TABLE_NAME, NULL PARTITION_NAME, 
  NULL STATISTICS_IN_HISTORY FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    10 NUM_RECORDS,
    'PARTITION' AGGREGATE_BY      /* TABLE, PARTITION */
  FROM
    DUAL
)
SELECT
  OWNER,
  TABLE_NAME,
  PARTITION_NAME,
  TO_CHAR(STATISTICS_IN_HISTORY, 99999999999999999990) STATISTICS_IN_HISTORY
FROM
( SELECT
    TSH.OWNER,
    TSH.TABLE_NAME,
    DECODE(BI.AGGREGATE_BY, 'PARTITION', TSH.PARTITION_NAME, NULL) PARTITION_NAME,
    COUNT(*) STATISTICS_IN_HISTORY,
    BI.NUM_RECORDS
  FROM
    BASIS_INFO BI,
    DBA_TAB_STATS_HISTORY TSH
  GROUP BY
    TSH.OWNER,
    TSH.TABLE_NAME,
    DECODE(BI.AGGREGATE_BY, 'PARTITION', TSH.PARTITION_NAME, NULL),
    BI.NUM_RECORDS
  ORDER BY
    COUNT(*) DESC
)
WHERE
  ( NUM_RECORDS = -1 OR ROWNUM <= NUM_RECORDS )
));