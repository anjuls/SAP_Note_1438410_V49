SELECT NULL OWNER, NULL TABLE_NAME, NULL TABLESPACES FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL TABLE_NAME, NULL TABLESPACES FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT
    'SAP%' OWNER
  FROM
    DUAL
)
SELECT
  OWNER,
  TABLE_NAME,
  TABLESPACES
FROM
( SELECT DISTINCT
    OWNER,
    TABLE_NAME,
    LISTAGG(TABLESPACE_NAME, ', ') WITHIN GROUP (ORDER BY TABLESPACE_NAME) OVER 
      (PARTITION BY OWNER, TABLE_NAME) TABLESPACES
  FROM
  ( SELECT DISTINCT
      I.OWNER,
      I.TABLE_NAME,
      I.TABLESPACE_NAME
    FROM
      BASIS_INFO BI,
      DBA_INDEXES I
    WHERE
      I.OWNER LIKE BI.OWNER AND
      I.INDEX_TYPE NOT IN ('IOT - TOP', 'LOB')  
  )
)
WHERE
  TABLESPACES LIKE '%,%'
ORDER BY
  OWNER,
  TABLE_NAME
));

