SELECT NULL OWNER, NULL TABLE_NAME, NULL PARTITION_NAME, NULL PART_ROWS, 
  NULL SIZE_MB, NULL "SIZE_%", NULL CREATION_TIME FROM DUAL WHERE 1 = 0
UNION ALL (
SELECT NULL OWNER, NULL TABLE_NAME, NULL PARTITION_NAME, NULL PART_ROWS, 
  NULL SIZE_MB, NULL "SIZE_%", NULL CREATION_TIME FROM DUAL WHERE 1 = 0
) UNION ALL ( SELECT * FROM (
WITH BASIS_INFO AS
( SELECT /*+ MATERIALIZE */
    'SAP%' OWNER,
    '/BIC/EICDECPCA3' TABLE_NAME
  FROM
    DUAL
),
TAB_PARTITIONS AS
( SELECT /*+ MATERIALIZE */
    DTP.TABLE_OWNER,
    DTP.TABLE_NAME,
    DTP.PARTITION_NAME,
    DTP.PARTITION_POSITION,
    DTP.NUM_ROWS
  FROM
    BASIS_INFO BI,
    DBA_TAB_PARTITIONS DTP
  WHERE
    DTP.TABLE_OWNER LIKE BI.OWNER AND
    DTP.TABLE_NAME LIKE BI.TABLE_NAME
),
OBJECTS AS
( SELECT /*+ MATERIALIZE */
    O.OWNER,
    O.OBJECT_NAME,
    O.SUBOBJECT_NAME,
    O.CREATED
  FROM
    BASIS_INFO BI,
    DBA_OBJECTS O
  WHERE
    O.OWNER LIKE BI.OWNER AND
    O.OBJECT_NAME LIKE BI.TABLE_NAME 
),
SEGMENTS AS
( SELECT /*+ MATERIALIZE */
    DS.OWNER,
    DS.SEGMENT_NAME,
    DS.SEGMENT_TYPE,
    DS.PARTITION_NAME,
    DS.BYTES
  FROM
    BASIS_INFO BI,
    DBA_SEGMENTS DS
  WHERE
    DS.OWNER LIKE BI.OWNER AND
    DS.SEGMENT_NAME LIKE BI.TABLE_NAME
)
SELECT 
  OWNER,
  TABLE_NAME,
  PARTITION_NAME,
  TO_CHAR(PART_ROWS, 999999990) PART_ROWS,
  TO_CHAR(BYTES / 1024 / 1024, 9999990.99) SIZE_MB,
  TO_CHAR(RATIO_TO_REPORT(BYTES) OVER (PARTITION BY OWNER, TABLE_NAME) * 100, 990.99) "SIZE_%",
  TO_CHAR(CREATED, 'dd.mm.yyyy hh24:mi:ss') CREATION_TIME
FROM
( SELECT 
    DTP.TABLE_OWNER OWNER,
    DTP.TABLE_NAME TABLE_NAME,
    DTP.PARTITION_NAME PARTITION_NAME,
    DTP.PARTITION_POSITION PART_POSITION,
    DTP.NUM_ROWS PART_ROWS,
    NVL(DS.BYTES, 0) BYTES,
    O.CREATED
  FROM
    TAB_PARTITIONS DTP,
    OBJECTS O,
    SEGMENTS DS
  WHERE
    DTP.TABLE_OWNER = O.OWNER AND
    DTP.TABLE_NAME = O.OBJECT_NAME AND
    DTP.PARTITION_NAME = O.SUBOBJECT_NAME AND
    DS.SEGMENT_TYPE (+) = 'TABLE PARTITION' AND
    DS.OWNER (+) = O.OWNER AND
    DS.SEGMENT_NAME (+) = O.OBJECT_NAME AND
    DS.PARTITION_NAME (+) = O.SUBOBJECT_NAME
) S
ORDER BY
  S.OWNER,
  S.TABLE_NAME,
  S.PART_POSITION
));